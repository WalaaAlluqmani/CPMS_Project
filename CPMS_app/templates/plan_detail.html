{% extends 'base.html' %}
{% load static %}

{% block title %}ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø®Ø·Ø©{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto p-6" dir="rtl">

    <!-- Header Ø§Ù„Ø®Ø·Ø© -->
    <div class="mb-6">
        <h1 class="text-2xl font-bold">{{ plan.plan_name }} <span class="text-sm font-normal">Ø§Ù„Ø­Ø§Ù„Ø©: 
            {% if plan.is_active %}
                <span class="text-green-600">Ù†Ø´Ø·Ø©</span>
            {% else %}
                <span class="text-gray-500">Ù…Ù†ØªÙ‡ÙŠØ©</span>
            {% endif %}
        </span>
    </h1>
        <p>Ø§Ù„Ø±Ø¤ÙŠØ©: {{ plan.vision }}</p>
        <p>Ø§Ù„Ø±Ø³Ø§Ù„Ø©: {{ plan.mission }}</p>
        <p>Ø§Ù„ÙØªØ±Ø©: {{ plan.start_date }} - {{ plan.end_date }}</p>
       
    </div>
<section>jj</section>
 
    <div class="grid grid-cols-3 gap-4 mb-6">
        <div class="bg-white p-4 rounded shadow text-center">
            <h3 class="font-semibold">Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù</h3>
            <p class="text-xl">{{ plan.goals.count }}</p>
        </div>
        <div class="grid grid-cols-3 gap-4 mb-6">
        <div class="bg-white p-4 rounded shadow text-center">
            <h3 class="font-semibold">Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø§Øª</h3>
            <p class="text-xl">{{ plan.initiatives_qs.count }}</p>
        </div>
        </div>
{% load static %}
<div class="dashboard">

    <!-- ğŸ”¹ Ù…Ù„Ø®Øµ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù -->
    <div class="goals-summary">
        <h2>Ù…Ù„Ø®Øµ Ø§Ù„Ø£Ù‡Ø¯Ø§Ù</h2>
        <ul>
            <li>Ù„Ù… ØªØ¨Ø¯Ø£: {{ goals_not_started }}</li>
            <li>Ø¬Ø§Ø±ÙŠØ©: {{ goals_in_progress }}</li>
            <li>Ù…ÙƒØªÙ…Ù„Ø©: {{ goals_completed }}</li>
            <li>Ù…ØªØ£Ø®Ø±Ø©: {{ goals_delayed }}</li>
        </ul>
    </div>

    <!-- ğŸ”¹ Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø§Øª -->
    <div class="initiatives-summary">
        <h2>Ù…Ù„Ø®Øµ Ø§Ù„Ù…Ø¨Ø§Ø¯Ø±Ø§Øª</h2>
        <ul>
            <li>Ù„Ù… ØªØ¨Ø¯Ø£: {{ initiatives_not_started }}</li>
            <li>Ø¬Ø§Ø±ÙŠØ©: {{ initiatives_in_progress }}</li>
            <li>Ù…ÙƒØªÙ…Ù„Ø©: {{ initiatives_completed }}</li>
            <li>Ù…ØªØ£Ø®Ø±Ø©: {{ initiatives_delayed }}</li>
        </ul>
    </div>

    <!-- ğŸ”¹ Ø£Ù‡Ù… 3 Ø£Ù‡Ø¯Ø§Ù -->
    <div class="top-goals">
        <h2>Ø£Ù‡Ù… 3 Ø£Ù‡Ø¯Ø§Ù Ø­Ø³Ø¨ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</h2>
        <ol>
            {% for goal in top_3_goals %}
                <li>{{ goal.goal_title }} - Ø£ÙˆÙ„ÙˆÙŠØ©: {{ goal.goal_priority }}</li>
            {% endfor %}
        </ol>
    </div>

    <!-- ğŸ”¹ Ø£Ù‡Ù… 3 Ù…Ø¨Ø§Ø¯Ø±Ø§Øª -->
    <div class="top-initiatives">
        <h2>Ø£Ù‡Ù… 3 Ù…Ø¨Ø§Ø¯Ø±Ø§Øª Ø­Ø³Ø¨ Ø§Ù„Ø£ÙˆÙ„ÙˆÙŠØ©</h2>
        <ol>
            {% for initiative in top_3_initiative %}
                <li>{{ initiative.title }} - Ø£ÙˆÙ„ÙˆÙŠØ©: {{ initiative.priority }}</li>
            {% endfor %}
        </ol>
    </div>

    <!-- ğŸ”¹ ØªÙ‚Ø¯Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø§Øª (Ù„Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù… ÙÙ‚Ø·) -->
    {% if departments_progress %}
    <div class="departments-progress">
        <h2>ØªÙ‚Ø¯Ù… Ø§Ù„Ø¥Ø¯Ø§Ø±Ø§Øª</h2>
        <ul>
            {% for dept in departments_progress %}
                {% with total=dept.total_goals completed=dept.completed_goals %}
                    <li>{{ dept.department__department_name }}: {{ completed }}/{{ total }} Ø£Ù‡Ø¯Ø§Ù Ù…ÙƒØªÙ…Ù„Ø©</li>
                {% endwith %}
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    <!-- ğŸ”¹ ØªÙ‚Ø¯Ù… Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ† (Ù„Ù„Ù…Ø¯ÙŠØ± Ø£Ùˆ Ø§Ù„Ù…Ø¯ÙŠØ± Ø§Ù„Ø¹Ø§Ù…) -->
    {% if employees_progress %}
    <div class="employees-progress">
        <h2>ØªÙ‚Ø¯Ù… Ø§Ù„Ù…ÙˆØ¸ÙÙŠÙ†</h2>
        <ul>
            {% for emp in employees_progress %}
                <li>{{ emp.userinitiative__user__username }}: {{ emp.completed_initiatives }} Ù…Ø¨Ø§Ø¯Ø±Ø§Øª Ù…ÙƒØªÙ…Ù„Ø©</li>
            {% endfor %}
        </ul>
    </div>
    {% endif %}

   

    <!-- ğŸ”¹ Ø²Ø± Ø§Ù„ØªØ¹Ø¯ÙŠÙ„ -->
    {% if can_edit %}
        <div class="edit-plan">
            <a href="{% url 'plan_edit' plan.id %}" class="btn btn-primary">ØªØ¹Ø¯ÙŠÙ„ Ø§Ù„Ø®Ø·Ø©</a>
        </div>
    {% endif %}

</div>


    <a href="{% url 'goal_create' plan.id %}"
                        class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-semibold">
                        Ø¥Ø¶Ø§ÙØ© Ù‡Ø¯Ù
                    </a>
            {% include 'partials/goals_list.html' %}
             {% endblock %}       